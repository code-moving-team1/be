# ë¬´ë¹™

> ## 2025.04.10 - 2025.11.10 </br>
>
> ### ì½”ë“œì‡ ìŠ¤í”„ë¦°íŠ¸ í’€ìŠ¤íƒ 7ê¸° ê³ ê¸‰ í”„ë¡œì íŠ¸ 1íŒ€ (BackEnd) </br>
>
> [FrontEnd Github ë°”ë¡œê°€ê¸° ğŸ”—](https://github.com/code-moving-team1/fe)

- [[ë¬´ë¹™] í™ˆí˜ì´ì§€](https://fe-real.vercel.app)
- [ğŸ—‚ï¸ íŒ€ ë¬¸ì„œ](https://www.notion.so/Team-1-Moving-2a302c9248648010ae36ea03ecd05cf5?source=copy_link)
- [ğŸ” API ëª…ì„¸](https://www.notion.so/API-2a302c92486481ebaf28e05f9798ca47)

</br>

## ğŸ› ï¸ ê¸°ìˆ ìŠ¤íƒ

<!-- Language / Runtime -->

### ğŸ”§ Language / Runtime

![Node.js](https://img.shields.io/badge/Node.js-339933?style=for-the-badge&logo=nodedotjs&logoColor=white)
![TypeScript](https://img.shields.io/badge/TypeScript-3178C6?style=for-the-badge&logo=typescript&logoColor=white)

<!-- Web Framework -->

### ğŸ§­ Web Framework

![Express](https://img.shields.io/badge/Express-000000?style=for-the-badge&logo=express&logoColor=white)

<!-- Auth -->

### ğŸ” Auth

![Passport](https://img.shields.io/badge/Passport-34E27A?style=for-the-badge&logo=passport&logoColor=white)
![JWT](https://img.shields.io/badge/JWT-000000?style=for-the-badge&logo=json-web-tokens&logoColor=white)
![Google](https://img.shields.io/badge/Google%20OAuth-4285F4?style=for-the-badge&logo=google&logoColor=white)
![Kakao](https://img.shields.io/badge/Kakao%20Login-FFCD00?style=for-the-badge&logo=kakaotalk&logoColor=000)
![Naver](https://img.shields.io/badge/Naver%20Login-03C75A?style=for-the-badge&logo=naver&logoColor=white)
![Session](https://img.shields.io/badge/Session-6DB33F?style=for-the-badge&logo=databricks&logoColor=white)

<!-- Database / Infra -->

### ğŸ—ƒï¸ Database / Infra

![Prisma](https://img.shields.io/badge/Prisma-ORM-2D3748?style=for-the-badge&logo=prisma&logoColor=white)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-316192?style=for-the-badge&logo=postgresql&logoColor=white)
![Neon](https://img.shields.io/badge/Neon-00E599?style=for-the-badge&logo=neon&logoColor=white)
![Railway](https://img.shields.io/badge/Railway-0B0D0E?style=for-the-badge&logo=railway&logoColor=white)

<!-- Realtime -->

### âš¡ Realtime

![Socket.io](https://img.shields.io/badge/Socket.io-010101?style=for-the-badge&logo=socketdotio&logoColor=white)

<!-- Validation / Utils -->

### ğŸ§ª Validation / Utils

![Zod](https://img.shields.io/badge/Zod-3E67B1?style=for-the-badge&logo=zod&logoColor=white)
![Axios](https://img.shields.io/badge/Axios-5A29E4?style=for-the-badge&logo=axios&logoColor=white)
![bcrypt](https://img.shields.io/badge/bcrypt-338DFF?style=for-the-badge&logo=keepassxc&logoColor=white)
![CORS](https://img.shields.io/badge/CORS-EB5424?style=for-the-badge)
![Morgan](https://img.shields.io/badge/Morgan-000000?style=for-the-badge)
![dotenv](https://img.shields.io/badge/dotenv-000000?style=for-the-badge)
![Toss Payments](https://img.shields.io/badge/Toss%20Payments-0064FF?style=for-the-badge)

<!-- Background Jobs / Scheduling -->

### â° Background Jobs / Scheduling

![Cron](https://img.shields.io/badge/Cron-4B5563?style=for-the-badge)

<!-- Tooling -->

### ğŸ§° Tooling

![github](https://img.shields.io/badge/GitHub-100000?style=for-the-badge&logo=github&logoColor=white) ![discord](https://img.shields.io/badge/Discord-7289DA?style=for-the-badge&logo=discord&logoColor=white) ![notion](https://img.shields.io/badge/Notion-000000?style=for-the-badge&logo=notion&logoColor=white) ![Swagger](https://img.shields.io/badge/-Swagger-%23Clojure?style=for-the-badge&logo=swagger&logoColor=white) ...etc

</br>

## ğŸ’ êµ¬ì„±ì›

|           ì •ìš°ì§„            |      ì´ì˜ˆì›      |      ê¹€íƒœí™      |
| :-------------------------: | :--------------: | :--------------: |
| **íŒ€ì¥** <br/> ë°°í¬ ë° ê´€ë¦¬ | GitHub ì´ìŠˆ ê´€ë¦¬ | GitHub ì´ìŠˆ ê´€ë¦¬ |

</br>

## ğŸ“‹ íŒ€ì›ë³„ êµ¬í˜„ ê¸°ëŠ¥ ìƒì„¸

### [ì´ì˜ˆì›]

- Auth API êµ¬í˜„
  - ì¸ì¦/ì¸ê°€ í† í° ê¸°ëŠ¥ êµ¬í˜„
  - êµ¬ê¸€, ì¹´ì¹´ì˜¤, ë„¤ì´ë²„ OAuth Strategy ë° ê¸°ëŠ¥ êµ¬í˜„
  - ë¯¸ë“¤ì›¨ì–´ë¥¼ í†µí•œ ì¸ì¦/ì¸ê°€ ê¸°ëŠ¥ êµ¬í˜„
- Mover, Customer API êµ¬í˜„
- Profile API êµ¬í˜„
- DirectQuoteRequest API êµ¬í˜„
- Likes API êµ¬í˜„
- MoveRequest /customerìš© API êµ¬í˜„
- Quote API êµ¬í˜„
- Review ì¡°íšŒ API êµ¬í˜„
- DB ìŠ¤í‚¤ë§ˆ ì„¤ê³„ ë° êµ¬í˜„
- ì—ëŸ¬ ì¹´íƒˆë¡œê·¸ ì¼ë¶€ ì‘ì„±

### [ì •ìš°ì§„]

- ê¸°ì´ˆì„¸íŒ…
  - ë°±ì—”ë“œí´ë”ë§ (3-Layer Architecture)
  - schema.prisma ì„¤ê³„
- moveRequest API êµ¬í˜„
  - ê³ ê°ì´ ì´ì‚¬ìš”ì²­ ìƒì„±, ì¡°ê±´ì— ë§ëŠ” ì´ì‚¬ìš”ì²­ ë¦¬ìŠ¤íŠ¸, ì´ì‚¬ìš”ì²­ ë‹¨ê±´ ìƒì„¸ ì¡°íšŒ
- Review API êµ¬í˜„
  - ê³ ê°ì´ ì‘ì„±ê°€ëŠ¥í•œ ë¦¬ë·° ë¦¬ìŠ¤íŠ¸, ë¦¬ë·°ì‘ì„±, ë‚´ê°€ ì‘ì„±í•œ ë¦¬ë·° ë¦¬ìŠ¤íŠ¸
- Notification API êµ¬í˜„
  - ì•Œë¦¼ ëª©ë¡ ì¡°íšŒ, UnreadCnt, ë‹¨ê±´ì½ìŒ, ëª¨ë‘ì½ìŒ
  - Socket.IOë¡œ ì´ìš©í•´ ì‹¤ì‹œê°„ ì•Œë¦¼
- Booking API êµ¬í˜„
  - ê²¬ì í™•ì •ì‹œ transaction ë¡œì§ êµ¬í˜„
- Chat API êµ¬í˜„
  - Socket.IOë¡œ ì´ìš©í•´ ì‹¤ì‹œê°„ ì•Œë¦¼
  - ì—°ê²° ì‹œ ì´ˆê¸° chat:history ì „ë‹¬, chat:message ë¸Œë¡œë“œìºìŠ¤íŠ¸, chat:system ì…Â·í‡´ì¥/ì˜¤ë¥˜ ë©”ì‹œì§€
- Payment API êµ¬í˜„
  - ê²°ì œìŠ¹ì¸, ê²°ì œë‚´ì—­ì¡°íšŒ
- transaction êµ¬í˜„
  - ê²¬ì í™•ì • tx : Booking ìƒì„±, MoveRequest/Quote ìƒíƒœ ë³€ê²½, ê´€ë ¨ ì•Œë¦¼ ë°œì†¡ê¹Œì§€ ë‹¨ì¼ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì²˜ë¦¬, ë©±ë“±ì„± í‚¤(idempotency key)ë¡œ ì¤‘ë³µ í™•ì • ë°©ì§€, ì‹¤íŒ¨ ì‹œ ì „ì²´ ë¡¤ë°±
  - ë¦¬ë·°ìƒì„± tx : Review ìƒì„±, ê¸°ì‚¬ ë³„ì , totalReviews ê°±ì‹ , ì•Œë¦¼ ë°œì†¡ ê¹Œì§€ ë‹¨ì¼ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì²˜ë¦¬, bookingId findUniqueë¡œ ì¤‘ë³µ ë°©ì§€, ì‹¤íŒ¨ ì‹œ ì „ì²´ ë¡¤ë°±
  - ê²°ì œìŠ¹ì¸ tx : payments draft ìƒì„±, í† ìŠ¤api confirmí™•ì¸, userì˜ points ìƒìŠ¹, payments draft update ,status APPROVED ì¸ì§€ í™•ì¸í•˜ì—¬ ì¤‘ë³µìŠ¹ì¸ ë°©ì§€, ì‹¤íŒ¨ì‹œ ì „ì²´ ë¡¤ë°±
- ìŠ¤ì¼€ì¤„ëŸ¬ êµ¬í˜„ ë° ì ìš©

  - Cron ì—”ë“œí¬ì¸íŠ¸ + í¬ë¡  í† í° ë°©ì‹ìœ¼ë¡œ Railway ë°°í¬í™˜ê²½ì— í¬ë¡ ì—°ë™í•˜ì—¬ ìš´ì˜ ìë™í™”

  ### [ê¹€íƒœí™]

- ì—ëŸ¬ í•¸ë“¤ëŸ¬ êµ¬í˜„
  - ì—ëŸ¬ ì¹´íƒˆë¡œê·¸ ì‘ì„± ë° ê·œê²©í™”
- ì´ì‚¬ ìš”ì²­(ì¼ë°˜ & ì§€ì •) ê²¬ì  ì‘ì„± API êµ¬í˜„
- ê²¬ì  ìƒì„¸ í˜ì´ì§€ (ì¼ë°˜ & ê¸°ì‚¬) API êµ¬í˜„

</br>

## âš“ï¸ ë°±ì—”ë“œ ì „ëµ

- **ë„ë©”ì¸ ëª¨ë¸**: ì£¼ìš” ê°œë…ì„ ë„ë©”ì¸ ëª¨ë¸ë¡œ ì¶”ìƒí™”í•˜ì—¬ ë³µì¡í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ê´€ë¦¬.

- **íŠ¸ëœì­ì…˜ ì²˜ë¦¬**:

  - ë™ì‹œ ì²˜ë¦¬ê°€ í•„ìš”í•œ ê¸°ëŠ¥ì— ëŒ€í•´ì„œ prisma transactionì„ ì´ìš©í•˜ì—¬ ë°ì´í„° ì •í•©ì„± ê´€ë¦¬

- **ë¡œê·¸ ê´€ë¦¬:** ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§ ë° ì‹œê°í™”
  - ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸: Winston â†’ AWS CloudWatch â†’ Lambda â†’ OpenSearch(Kibana)
  - ì‹œìŠ¤í…œ ë° ë„¤íŠ¸ì›Œí¬ ë¡œê·¸: Node Exporter / NginX Exporer â†’ Prometheus â†’ Grafana
- **ì‹¤ì‹œê°„ ì±„íŒ… ê¸°ëŠ¥**: `@nestjs/websockets`ì™€ `Socket.io`ë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ ê°„ ì‹¤ì‹œê°„ ë©”ì‹œì§€ ì „ë‹¬ ë° ê´€ë¦¬.
- **ìŠ¤ì¼€ì¤„ëŸ¬**: `Cron jobs`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì£¼ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ì‘ì—…ì„ ìë™í™”.
- **ê²°ì œ ì‹œìŠ¤í…œ**: ì™¸ë¶€ PGì‚¬ ê²°ì œ APIì™€ì˜ ì—°ë™ì„ í†µí•´ ê²°ì œ ì²˜ë¦¬ ìë™í™”.
- **ì‹¤ì‹œê°„ ì•Œë¦¼**: SSE ë‹¨ë°©í–¥ í†µì‹ ì„ í†µí•´ ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ì— ì•Œë¦¼ ì „ì†¡.
- **ìºì‹± ë° ë©”ì‹œì§€ í**: Redisë¥¼ í™œìš©í•˜ì—¬ ìì£¼ ì¡°íšŒí•˜ëŠ” ë°ì´í„°ë¥¼ ìºì‹±í•˜ê³  BullMQë¥¼ í†µí•´ ì—°ì‚° ì‘ì—… ë“±ì„ ë©”ì‹œì§€ íë¡œ ë¹„ë™ê¸° ì²˜ë¦¬

</br>

## ğŸ° í”„ë¡œì íŠ¸ íšŒê³ 

- ë°±ì—”ë“œ ê²°ê³¼ë¬¼: https://www.goforme.duckdns.org
- ë°œí‘œ ìë£Œ: https://www.notion.so/Team-1-Moving-2a302c9248648010ae36ea03ecd05cf5
- ì‹œì—° ì˜ìƒ: https://www.notion.so/Team-1-Moving-2a302c9248648010ae36ea03ecd05cf5
- ERD : https://dbdiagram.io/d/68a68254466887cb45ec0a2f

</br>

## ğŸ“ íŒŒì¼ êµ¬ì¡°

```
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ constants
â”‚   â”‚   â”œâ”€â”€ enums.ts
â”‚   â”‚   â””â”€â”€ notification.links.ts
â”‚   â”œâ”€â”€ controllers
â”‚   â”‚   â”œâ”€â”€ auth.controller.ts
â”‚   â”‚   â”œâ”€â”€ booking.controller.ts
â”‚   â”‚   â”œâ”€â”€ cron.controller.ts
â”‚   â”‚   â”œâ”€â”€ customer.controller.ts
â”‚   â”‚   â”œâ”€â”€ directQuoteRequest.controller.ts
â”‚   â”‚   â”œâ”€â”€ likes.controller.ts
â”‚   â”‚   â”œâ”€â”€ mover.controller.ts
â”‚   â”‚   â”œâ”€â”€ moveRequest.controller.ts
â”‚   â”‚   â”œâ”€â”€ payments.controller.ts
â”‚   â”‚   â”œâ”€â”€ quote.controller.ts
â”‚   â”‚   â””â”€â”€ review.controller.ts
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ lib
â”‚   â”‚   â”œâ”€â”€ passport.ts
â”‚   â”‚   â””â”€â”€ prisma.ts
â”‚   â”œâ”€â”€ middlewares
â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”œâ”€â”€ cronAuth.ts
â”‚   â”‚   â”œâ”€â”€ error.middleware.ts
â”‚   â”‚   â””â”€â”€ passport
â”‚   â”œâ”€â”€ repositories
â”‚   â”‚   â”œâ”€â”€ booking.repository.ts
â”‚   â”‚   â”œâ”€â”€ customer.repository.ts
â”‚   â”‚   â”œâ”€â”€ directQuoteRequest.repository.ts
â”‚   â”‚   â”œâ”€â”€ likes.repository.ts
â”‚   â”‚   â”œâ”€â”€ mover.repository.ts
â”‚   â”‚   â”œâ”€â”€ moveRequest.repository.ts
â”‚   â”‚   â”œâ”€â”€ notification.repository.ts
â”‚   â”‚   â”œâ”€â”€ payments.repository.ts
â”‚   â”‚   â”œâ”€â”€ points.repository.ts
â”‚   â”‚   â”œâ”€â”€ quote.repository.ts
â”‚   â”‚   â”œâ”€â”€ refresh.repository.ts
â”‚   â”‚   â””â”€â”€ review.repository.ts
â”‚   â”œâ”€â”€ routes
â”‚   â”‚   â”œâ”€â”€ auth.routes.ts
â”‚   â”‚   â”œâ”€â”€ booking.routes.ts
â”‚   â”‚   â”œâ”€â”€ cron.routes.ts
â”‚   â”‚   â”œâ”€â”€ customer.routes.ts
â”‚   â”‚   â”œâ”€â”€ directQuoteRequest.routes.ts
â”‚   â”‚   â”œâ”€â”€ likes.routes.ts
â”‚   â”‚   â”œâ”€â”€ mover.routes.ts
â”‚   â”‚   â”œâ”€â”€ moveRequest.routes.ts
â”‚   â”‚   â”œâ”€â”€ notification.routes.ts
â”‚   â”‚   â”œâ”€â”€ payments.routes.ts
â”‚   â”‚   â”œâ”€â”€ quote.routes.ts
â”‚   â”‚   â””â”€â”€ review.routes.ts
â”‚   â”œâ”€â”€ schemas
â”‚   â”‚   â”œâ”€â”€ moveRequest.schema.ts
â”‚   â”‚   â”œâ”€â”€ quote.schema.ts
â”‚   â”‚   â””â”€â”€ review.schema.ts
â”‚   â”œâ”€â”€ services
â”‚   â”‚   â”œâ”€â”€ auth.service.ts
â”‚   â”‚   â”œâ”€â”€ booking.service.ts
â”‚   â”‚   â”œâ”€â”€ cron.service.ts
â”‚   â”‚   â”œâ”€â”€ customer.service.ts
â”‚   â”‚   â”œâ”€â”€ directQuoteRequest.service.ts
â”‚   â”‚   â”œâ”€â”€ likes.service.ts
â”‚   â”‚   â”œâ”€â”€ mover.service.ts
â”‚   â”‚   â”œâ”€â”€ moveRequest.service.ts
â”‚   â”‚   â”œâ”€â”€ notification.service.ts
â”‚   â”‚   â”œâ”€â”€ payments.service.ts
â”‚   â”‚   â”œâ”€â”€ quote.service.ts
â”‚   â”‚   â”œâ”€â”€ review.service.ts
â”‚   â”‚   â””â”€â”€ tx
â”‚   â”œâ”€â”€ sockets
â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”œâ”€â”€ chat.ts
â”‚   â”‚   â”œâ”€â”€ emitters.ts
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ rooms.ts
â”‚   â”‚   â””â”€â”€ types.ts
â”‚   â”œâ”€â”€ types
â”‚   â”‚   â”œâ”€â”€ domain.ts
â”‚   â”‚   â”œâ”€â”€ prisma-extended.ts
â”‚   â”‚   â”œâ”€â”€ rating.ts
â”‚   â”‚   â”œâ”€â”€ realtime.ts
â”‚   â”‚   â””â”€â”€ review.ts
â”‚   â””â”€â”€ utils
â”‚       â”œâ”€â”€ cookies.ts
â”‚       â”œâ”€â”€ errorCatalog.ts
â”‚       â”œâ”€â”€ HttpError.ts
â”‚       â”œâ”€â”€ mappers
â”‚       â”œâ”€â”€ rating-helpers.ts
â”‚       â””â”€â”€ validation
â”œâ”€â”€ test.http
â””â”€â”€ tsconfig.json


```

## âš™ï¸ í™˜ê²½ë³€ìˆ˜

```
NODE_ENV="production"

DATABASE_URL="postgresql_url"

JWT_SECRET="JWT_SECRET"
SESSION_SECRET="SESSION_SECRET"
CRON_TOKEN="CRON_TOKEN_SECRET"

CORS_ORIGIN="https://fe-real.vercel.app,http://localhost:3000"
FRONTEND_URL="https://fe-real.vercel.app"
# FRONTEND_URL="http://localhost:3000"

GOOGLE_CLIENT_ID="GOOGLE_CLIENT_ID.apps.googleusercontent.com"
GOOGLE_CLIENT_SECRET="GOOGLE_CLIENT_SECRET"

NAVER_CLIENT_ID="NAVER_CLIENT_ID"
NAVER_CLIENT_SECRET="NAVER_CLIENT_SECRET"

KAKAO_CLIENT_ID="KAKAO_CLIENT_ID"
KAKAO_CLIENT_SECRET="KAKAO_CLIENT_SECRET"

TOSS_SECRET_KEY="test_sk_TOSS_SECRET_KEY"
TOSS_TEST=true

```
